function randomInt(e,a){return e=Math.ceil(e),a=Math.floor(a),Math.floor(Math.random()*(a-e+1))+e}function keyCallBack(e){if(__instructions)"space"==e&&($("#loader").show(),myAPI.endPoints.GET_stimuli(__stage,placeStimuli),__instructions=!1,screenfull.isFullscreen?console.log("La pantalla ya está maximizada"):screenfull.request(),$("#space_bar").hide(),$("#instructions").hide(),$("#rndCount").hide(),$("#blank").removeClass("blank"),$("#blank").removeClass("blank_medium"),$("#blank").addClass("blank_bigger"));else{if("space"==e)return!1;"e"==e&&iatAnswer(e),"i"==e&&iatAnswer(e)}}function setBtns(){$("#leftCol").on("click",function(){keyCallBack("e")}),$("#rightCol").on("click",function(){keyCallBack("i")}),$("#space_bar").on("click",function(){keyCallBack("space")})}function iatAnswer(e){const a=__trialCount+1,r=`#stimHolder_${a}`,n=$(r).attr("label");if("e"==e)if(__left.includes(n)){const e=getLatency();saveTrial(e),console.log(`correcto (${e} ms)`),hideText("info"),__trialCount+=1,playIAT()}else console.log("incorrecto"),__errorCnt+=1,showError();else if(__right.includes(n)){const e=getLatency();saveTrial(e),console.log(`correcto (${e} ms)`),hideText("info"),__trialCount+=1,playIAT()}else console.log("incorrecto"),__errorCnt+=1,showError()}function getLatency(){const e=new Date,a=Math.abs(e-__trialStart);return a}function saveTrial(e){const a=__trialCount+1,r=`#stimHolder_${a}`,n=$(r).attr("label"),t=$(r).attr("type"),l=$(r).attr("val"),o=__errorCnt,s={latency:e,type:t,label:n,value:l,error:o};__results[`round_${__stage}`].push(s)}function showError(){var e=$("#errorMrk"),a=$("#errorMsg");e.show(),a.show()}function assignLabelsAndText(e,a,r){var n=$("#leftColTxt"),t=$("#rightColTxt"),l=n.children("span")[0],o=n.children("span")[1],s=n.children("span")[2],i=t.children("span")[0],c=t.children("span")[1],d=t.children("span")[2],_=__order;r&&(0===_?_=1:1===_&&(_=0));const u=0===__order?1:-1,p=0===_?1:-1;if("word&img"==e){const e=a;__left=[__wrdLabel[__order],__imgLabel[_]],__right=[__wrdLabel[__order+1*u],__imgLabel[_+1*p]],l.innerText=__imgCat[_],i.innerText=__imgCat[_+1*p],s.innerText=__wrdCat[__order],d.innerText=__wrdCat[__order+1*u],l.style.display="block",o.style.display="block",s.style.display="block",i.style.display="block",c.style.display="block",d.style.display="block",$("#instructions").html(e)}else if("word"==e){const e=a;__left=[__wrdLabel[__order]],__right=[__wrdLabel[__order+1*u]],s.innerText=__wrdCat[__order],d.innerText=__wrdCat[__order+1*u],s.style.display="block",d.style.display="block",$("#instructions").html(e)}else{if("img"!=e)throw"Invalid stageType";{const e=a;__left=[__imgLabel[_]],__right=[__imgLabel[_+1*p]],l.innerText=__imgCat[_],i.innerText=__imgCat[_+1*p],l.style.display="block",i.style.display="block",$("#instructions").html(e)}}}function hideText(e){var a=$("#leftColTxt"),r=$("#rightColTxt"),n=a.children("span")[0],t=a.children("span")[1],l=a.children("span")[2],o=r.children("span")[0],s=r.children("span")[1],i=r.children("span")[2],c=$("#rndCount"),d=$("#errorMrk"),_=$("#errorMsg");switch(e){case"columns":n.style.display="none",o.style.display="none",t.style.display="none",s.style.display="none",l.style.display="none",i.style.display="none";break;case"info":c.hide(),d.hide(),_.hide()}}function showInstructions(){switch(__instructions=!0,$("#space_bar").text("Toca este texto para continuar"),__stage){case 1:$("#blank").removeClass("blank_bigger"),$("#blank").addClass("blank"),assignLabelsAndText("img","<h1>Instrucciones:</h1><ul><li>Orienta tu dispositivo en posición horizontal.</li><li>Observa las palabras que aparecen en la parte superior de la pantalla; éstas representan las categorías que tendrás que ordenar. Las palabras o imágenes que tienes que ordenar aparecerán una por una en el centro de la pantalla.</li><li>Cuando una imagen o palabra aparezca, toca el rectángulo de color verde que contenga la categoría a la que pertenece.</li><li> Ojo: las imágenes o palabras sólo pertenecen a una categoría. Si cometes un error, aparecerá una X, para corregir el error presiona la tecla correcta tan rápido como puedas.</li><ul>",!1);break;case 2:$("#blank").removeClass("blank_bigger"),$("#blank").addClass("blank_medium"),assignLabelsAndText("word","<p>En este bloque tendrás que categorizar palabras.</p><p><b>Palabras buenas:</b> competente, trabajador, constante, cariñoso, tierno, amoroso, dulce</p><p><b>Palabras malas:</b> agresivo, rudo, problemático, violento, mediocre, conformista, mentiroso, corrupto.</p><p>Recuerda que cuando una imagen o palabra aparezca, toca el rectángulo de color verde que contenga la categoría a la que pertenece.</p>",!1);break;case 3:$("#blank").removeClass("blank_bigger"),$("#blank").addClass("blank_medium"),assignLabelsAndText("word&img","<p>En esta sección tendrás que categorizar imágenes y palabras.</p><p>Las etiquetas azules corresponden a las palabras y las negras a las imágenes.</p><p>Recuerda que cuando una imagen o palabra aparezca, toca el rectángulo de color verde que contenga la categoría a la que pertenece.</p>",!1);break;case 4:$("#blank").removeClass("blank_bigger"),$("#blank").addClass("blank_medium"),assignLabelsAndText("word&img","<p>Ordena, nuevamente, las mismas categorías.</p><p>Recuerda que cuando una imagen o palabra aparezca, toca el rectángulo de color verde que contenga la categoría a la que pertenece.</p>",!1);break;case 5:$("#blank").removeClass("blank_bigger"),$("#blank").addClass("blank_medium"),assignLabelsAndText("img","<p>Aviso, ahora sólo hay dos categorías y han cambiado de posición. Practica en esta nueva configuración.</p><p>Recuerda que cuando una imagen o palabra aparezca, toca el rectángulo de color verde que contenga la categoría a la que pertenece.</p>",!0);break;case 6:$("#blank").removeClass("blank_bigger"),$("#blank").addClass("blank_medium"),assignLabelsAndText("word&img","<p>Observa la parte de arriba, ahora aparecen categorías dobles nuevamente.</p><p>Cuando una imagen o palabra aparezca, toca el rectángulo de color verde que contenga la categoría a la que pertenece.</p>",!0);break;case 7:$("#blank").removeClass("blank_bigger"),$("#blank").addClass("blank_medium"),assignLabelsAndText("word&img","<p>Ordena, nuevamente, las mismas categorías.</p><p>Recuerda que tienes que presionar la tecla <b>E</b> cuando la imagen o palabra pertenezca a la categoría del lado izquierdo. Cuando la palabra o la imagen pertenezca a la categoría de la derecha, presiona la tecla <b>I</>.</p>",!1)}$("#space_bar").show(),$("#instructions").show(),$("#rndCount").show()}function placeStimuli(e){const a=e.data.stimuli;__stageLength=a.length;for(let e=0;e<a.length;e++){const r=e+1,n=`#stimHolder_${r}`,t=a[e],l=t.type,o=t.label,s=t.content;$(n).removeClass("wrd"),$(n).hide(),"img"==l?$(n).html(`<img src='Static/imgs/stimuli/${s}.JPG'>`):($(n).html(s),$(n).addClass("wrd")),$(n).attr("label",o),$(n).attr("type",l),$(n).attr("val",s),$(".stimuli").imagesLoaded(function(){$("#loader").hide(),__trialCount=0,playIAT()})}}function playIAT(){const e=__trialCount+1;__trialCount<__stageLength?(0!=__trialCount&&$(`#stimHolder_${e-1}`).hide(),$(`#stimHolder_${e}`).show(),__trialStart=new Date,__errorCnt=0):($(`#stimHolder_${e-1}`).hide(),__stage+=1,IATloop())}function IATloop(){if($("#loader").hide(),__stage>7){const e={results:__results,order:__order};myAPI.endPoints.POST_results(e),window.location.href="/survey"}else 1==__stage&&(__order=randomInt(0,1));var e=[];__results[`round_${__stage}`]=e,$("#rndCount").text(`Ronda ${__stage} de 7`),hideText("columns"),hideText("info"),showInstructions()}var __order,__trialCount,__stageLength,__trialStart,__left,__right,myAPI,__stage=1,__imgCat=["Piel clara","Piel oscura"],__imgCatInstructions=["piel clara","piel oscura"],__wrdCat=["Bueno","Malo"],__wrdCatInstructions=["palabras buenas","palabras malas"],__imgLabel=["white","dark"],__wrdLabel=["good","bad"],__instructions=!1,__results={},__errorCnt=0;$(document).ready(function(){setBtns(),$("html,body").scrollTop(0),IATloop()});