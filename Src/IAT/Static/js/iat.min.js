function randomInt(a,e){return a=Math.ceil(a),e=Math.floor(e),Math.floor(Math.random()*(e-a+1))+a}function keyHandler(a,e=!1,r){var l;window.event?l=a.keyCode:a.which&&(l=a.which);var n=String.fromCharCode(l);if(" "===n&&(n="space"),e&&console.log("Key pressed:"+n),!r)return n;r(n)}function keyCallBack(a){if(__instructions)"space"==a&&($("#loader").show(),myAPI.endPoints.GET_stimuli(__stage,placeStimuli),__instructions=!1,screenfull.isFullscreen||screenfull.request(),$("#space_bar").hide(),$("#instructions").hide(),$("#rndCount").hide(),$("#blank").removeClass("blank"),$("#blank").removeClass("blank_medium"),$("#blank").addClass("blank_bigger"));else{if("space"==a)return!1;"e"==a&&iatAnswer(a),"i"==a&&iatAnswer(a)}}function iatAnswer(a){const e=__trialCount+1,r=`#stimHolder_${e}`,l=$(r).attr("label");if("e"==a)if(__left.includes(l)){const a=getLatency();saveTrial(a),hideText("info"),__trialCount+=1,playIAT()}else __errorCnt+=1,showError();else if(__right.includes(l)){const a=getLatency();saveTrial(a),hideText("info"),__trialCount+=1,playIAT()}else __errorCnt+=1,showError()}function getLatency(){const a=new Date,e=Math.abs(a-__trialStart);return e}function saveTrial(a){const e=__trialCount+1,r=`#stimHolder_${e}`,l=$(r).attr("label"),n=$(r).attr("type"),t=$(r).attr("val"),s=__errorCnt,o={latency:a,type:n,label:l,value:t,error:s};__results[`round_${__stage}`].push(o)}function showError(){var a=$("#errorMrk"),e=$("#errorMsg");a.show(),e.show()}function assignLabelsAndText(a,e,r){var l=$("#leftColTxt"),n=$("#rightColTxt"),t=l.children("span")[0],s=l.children("span")[1],o=l.children("span")[2],i=n.children("span")[0],d=n.children("span")[1],c=n.children("span")[2],_=__order;r&&(0===_?_=1:1===_&&(_=0));const u=0===__order?1:-1,p=0===__order?1:-1;if("word&img"==a){const a=e;__left=[__wrdLabel[__order],__imgLabel[_]],__right=[__wrdLabel[__order+1*u],__imgLabel[_+1*p]],t.innerText=__imgCat[_],i.innerText=__imgCat[_+1*p],o.innerText=__wrdCat[__order],c.innerText=__wrdCat[__order+1*u],t.style.display="block",s.style.display="block",o.style.display="block",i.style.display="block",d.style.display="block",c.style.display="block",$("#instructions").html(a)}else if("word"==a){const a=e;__left=[__wrdLabel[__order]],__right=[__wrdLabel[__order+1*u]],o.innerText=__wrdCat[__order],c.innerText=__wrdCat[__order+1*u],o.style.display="block",c.style.display="block",$("#instructions").html(a)}else{if("img"!=a)throw"Invalid stageType";{const a=e;__left=[__imgLabel[_]],__right=[__imgLabel[_+1*p]],t.innerText=__imgCat[_],i.innerText=__imgCat[_+1*p],t.style.display="block",i.style.display="block",$("#instructions").html(a)}}}function hideText(a){var e=$("#leftColTxt"),r=$("#rightColTxt"),l=e.children("span")[0],n=e.children("span")[1],t=e.children("span")[2],s=r.children("span")[0],o=r.children("span")[1],i=r.children("span")[2],d=$("#rndCount"),c=$("#errorMrk"),_=$("#errorMsg");switch(a){case"columns":l.style.display="none",s.style.display="none",n.style.display="none",o.style.display="none",t.style.display="none",i.style.display="none";break;case"info":d.hide(),c.hide(),_.hide()}}function showInstructions(){switch(__instructions=!0,$("#space_bar").text("Presiona la barra espaciadora para comenzar"),__stage){case 1:$("#blank").removeClass("blank_bigger"),$("#blank").addClass("blank"),assignLabelsAndText("img","<h1>Instrucciones:</h1><ul><li>Coloca tus dedos índices en las letras E y I de tu teclado.</li><li>Observa las palabras que aparecen en la parte superior de la pantalla; éstas representan las categorías que tendrás que ordenar. Las palabras o imágenes que tienes que ordenar aparecerán una por una en el centro de la pantalla.</li><li>Tu tarea será presionar la tecla E cuando la imagen o palabra pertenezca a la categoría del lado izquierdo. Cuando la palabra o la imagen pertenezca a la categoría de la derecha, presiona la tecla I.</li><li> Ojo: las imágenes o palabras sólo pertenecen a una categoría. Si cometes un error, aparecerá una X, para corregir el error presiona la tecla correcta tan rápido como puedas.</li><ul>",!1);break;case 2:$("#blank").removeClass("blank_bigger"),$("#blank").addClass("blank_medium"),assignLabelsAndText("word","<p>En este bloque tendrás que categorizar palabras.</p><p><b>Palabras buenas:</b> competente, trabajador, constante, cariñoso, tierno, amoroso, dulce</p><p><b>Palabras malas:</b> agresivo, rudo, problemático, violento, mediocre, conformista, mentiroso, corrupto.</p><p>Recuerda que tienes que presionar la tecla <b>E</b> cuando la imagen o palabra pertenezca a la categoría del lado izquierdo. Cuando la palabra o la imagen pertenezca a la categoría de la derecha, presiona la tecla <b>I</b>.</p>",!1);break;case 3:$("#blank").removeClass("blank_bigger"),$("#blank").addClass("blank_medium"),assignLabelsAndText("word&img","<p>En esta sección tendrás que categorizar imágenes y palabras.</p><p>Las etiquetas verdes corresponden a las palabras y las blancas a las imágenes.</p><p>Recuerda que tienes que presionar la tecla <b>E</b> cuando la imagen o palabra pertenezca a la categoría del lado izquierdo. Cuando la palabra o la imagen pertenezca a la categoría de la derecha, presiona la tecla <b>I</b>.</p>",!1);break;case 4:$("#blank").removeClass("blank_bigger"),$("#blank").addClass("blank_medium"),assignLabelsAndText("word&img","<p>Ordena, nuevamente, las mismas categorías.</p><p>Recuerda que tienes que presionar la tecla <b>E</b> cuando la imagen o palabra pertenezca a la categoría del lado izquierdo. Cuando la palabra o la imagen pertenezca a la categoría de la derecha, presiona la tecla <b>I</>.</p>",!1);break;case 5:$("#blank").removeClass("blank_bigger"),$("#blank").addClass("blank_medium"),assignLabelsAndText("img","<p>Aviso, ahora sólo hay dos categorías y han cambiado de posición. Practica en esta nueva configuración.</p><p>Recuerda que tienes que presionar la tecla <b>E</b> cuando la imagen o palabra pertenezca a la categoría del lado izquierdo. Cuando la palabra o la imagen pertenezca a la categoría de la derecha, presiona la tecla <b>I</b>.</p>",!0);break;case 6:$("#blank").removeClass("blank_bigger"),$("#blank").addClass("blank_medium"),assignLabelsAndText("word&img","<p>Observa la parte de arriba, ahora aparecen categorías dobles nuevamente.</p><p>Recuerda que tienes que presionar la tecla <b>E</b> cuando la imagen o palabra pertenezca a la categoría del lado izquierdo. Cuando la palabra o la imagen pertenezca a la categoría de la derecha, presiona la tecla <b>I</b>.</p>",!0);break;case 7:$("#blank").removeClass("blank_bigger"),$("#blank").addClass("blank_medium"),assignLabelsAndText("word&img","<p>Ordena, nuevamente, las mismas categorías.</p><p>Recuerda que tienes que presionar la tecla <b>E</b> cuando la imagen o palabra pertenezca a la categoría del lado izquierdo. Cuando la palabra o la imagen pertenezca a la categoría de la derecha, presiona la tecla <b>I</b>.</p>",!0)}$("#space_bar").show(),$("#instructions").show(),$("#rndCount").show()}function placeStimuli(a){const e=a.data.stimuli;__stageLength=e.length;for(let a=0;a<e.length;a++){const r=a+1,l=`#stimHolder_${r}`,n=e[a],t=n.type,s=n.label,o=n.content;$(l).removeClass("wrd"),$(l).hide(),"img"==t?$(l).html(`<img src='Static/imgs/stimuli/${o}.JPG'>`):($(l).html(o),$(l).addClass("wrd")),$(l).attr("label",s),$(l).attr("type",t),$(l).attr("val",o),$(".stimuli").imagesLoaded(function(){$("#loader").hide(),__trialCount=0,playIAT()})}}function playIAT(){const a=__trialCount+1;__trialCount<__stageLength?(0!=__trialCount&&$(`#stimHolder_${a-1}`).hide(),$(`#stimHolder_${a}`).show(),__trialStart=new Date,__errorCnt=0):($(`#stimHolder_${a-1}`).hide(),__stage+=1,IATloop())}function IATloop(){if($("#loader").hide(),__stage>7){const a={results:__results,order:__order};myAPI.endPoints.POST_results(a),window.location.href="/survey"}else 1==__stage&&(__order=randomInt(0,1));var a=[];__results[`round_${__stage}`]=a,$("#rndCount").text(`Ronda ${__stage} de 7`),hideText("columns"),hideText("info"),showInstructions()}var __order,__trialCount,__stageLength,__trialStart,__left,__right,myAPI,__stage=1,__imgCat=["Piel clara","Piel oscura"],__imgCatInstructions=["piel clara","piel oscura"],__wrdCat=["Bueno","Malo"],__wrdCatInstructions=["palabras buenas","palabras malas"],__imgLabel=["white","dark"],__wrdLabel=["good","bad"],__instructions=!1,__results={},__errorCnt=0;$(document).ready(function(){const a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,r=460,l=1e3;(a<l||e<r)&&alert("La resolución de tu dispositivo es muy pequeña para realizar esta prueba. Por favor, trata de hacer más grande la pantalla o ajusta la resolución y recarga la página"),$("html,body").scrollTop(0),IATloop(),$(document).keypress(function(a){a.preventDefault(),keyHandler(a,!1,keyCallBack)})});