function randomInt(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function keyHandler(e,t=!1,l){var a;window.event?a=e.keyCode:e.which&&(a=e.which);var i=String.fromCharCode(a);if(" "===i&&(i="space"),t&&console.log("Key pressed:"+i),!l)return i;l(i)}function keyCallBack(e){if(__instructions)"space"==e&&(myAPI.endPoints.GET_stimuli(__stage),__instructions=!1);else{if("space"==e)return!1;"e"==e&&iatAnswer(e),"i"==e&&iatAnswer(e)}}function iatAnswer(e){const t=__trialCount+1,l=`#stimHolder_${t}`,a=$(l).attr("label");"e"==e?__left.includes(a)?(console.log("correcto"),__trialCount+=1,playIAT()):console.log("incorrecto"):__right.includes(a)?(console.log("correcto"),__trialCount+=1,playIAT()):console.log("incorrecto")}function assignLabelsAndText(e,t){var l=$("#leftColTitle"),a=$("#rightColTitle"),i=l.children("span")[0],n=l.children("span")[1],_=l.children("span")[2],o=a.children("span")[0],r=a.children("span")[1],s=a.children("span")[2],c=__order;t&&(0===c?c=1:1===c&&(c=0));const d=0===c?1:-1;if("word&img"==e)__left=[__wrdLabel[c],__imgLabel[c]],__right=[__wrdLabel[c+1*d],__imgLabel[c+1*d]],i.innerText=__imgCat[c],o.innerText=__imgCat[c+1*d],_.innerText=__wrdCat[c],s.innerText=__wrdCat[c+1*d],i.style.display="block",n.style.display="block",_.style.display="block",o.style.display="block",r.style.display="block",s.style.display="block";else if("word"==e)__left=[__wrdLabel[c]],__right=[__wrdLabel[c+1*d]],_.innerText=__wrdCat[c],s.innerText=__wrdCat[c+1*d],_.style.display="block",s.style.display="block";else{if("img"!=e)throw"Invalid stageType";__left=[__imgLabel[c]],__right=[__imgLabel[c+1*d]],i.innerText=__imgCat[c],o.innerText=__imgCat[c+1*d],i.style.display="block",o.style.display="block"}}function showInstructions(){switch(__instructions=!0,__stage){case 1:assignLabelsAndText("word",!1);break;case 2:assignLabelsAndText("img",!1);break;case 3:case 4:assignLabelsAndText("word&img",!1);break;case 5:assignLabelsAndText("word",!0);break;case 6:case 7:assignLabelsAndText("word&img",!0)}}function placeStimuli(e){__stageLength=e.length;for(let t=0;t<e.length;t++){const l=t+1,a=`#stimHolder_${l}`,i=e[t],n=i.type,_=i.label,o=i.content;console.log(a),$(a).hide(),"img"==n?($(a).html(`<img src='../imgs/stimuli/${o}.jpg'>`),$(a).attr("label",_)):($(a).html(o),$(a).attr("label",_)),$(".stimuli").imagesLoaded(function(){$("#loader").hide(),__trialCount=0,playIAT()})}}function playIAT(){const e=__trialCount+1;__trialCount<__stageLength?(0!=__trialCount&&$(`#stimHolder_${e-1}`).hide(),$(`#stimHolder_${e}`).show(),__trialStart=new Date):($(`#stimHolder_${e-1}`).hide(),__stage+=1,IATloop())}function IATloop(){$("#loader").hide(),__stage>7||1==__stage&&(__order=randomInt(0,1)),$("#rndCount").text(`Ronda ${__stage} de 7`),showInstructions()}var __order,__trialCount,__stageLength,__trialStart,__left,__right,myAPI,__stage=1,__imgCat=["Piel clara","Piel oscura"],__wrdCat=["Bueno","Malo"],__imgLabel=["white","dark"],__wrdLabel=["good","bad"],__instructions=!1;$(document).ready(function(){IATloop(),$(document).keypress(function(e){e.preventDefault(),keyHandler(e,!0,keyCallBack)})});